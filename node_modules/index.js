const express = require('express');
const bodyParser = require('body-parser');

const app = express();
const port = 8080;

// 간단한 메모 저장소
const memos = [];

// JSON 요청을 파싱하기 위한 설정
app.use(bodyParser.json());

// 모든 메모를 반환하는 엔드포인트
app.get('/memos', (req, res) => {
  res.json(memos);
});

// 새로운 메모를 추가하는 엔드포인트
app.post('/memos', (req, res) => {
  const { content } = req.body;
  const newMemo = {
    id: memos.length + 1,
    content,
  };
  memos.push(newMemo);
  res.status(201).json(newMemo);
});

// 특정 메모를 수정하는 엔드포인트
app.put('/memos/:id', (req, res) => {
  const { id } = req.params;
  const { content } = req.body;

  const memo = memos.find(m => m.id === Number(id));

  if (!memo) {
    return res.status(404).json({ error: 'Memo not found' });
  }

  memo.content = content;

  res.json(memo);
});

// 특정 메모를 삭제하는 엔드포인트
app.delete('/memos/:id', (req, res) => {
  const { id } = req.params;

  const index = memos.findIndex(m => m.id === Number(id));

  if (index === -1) {
    return res.status(404).json({ error: 'Memo not found' });
  }

  memos.splice(index, 1);

  res.status(204).send();
});

app.listen(port, () => {
    console.log(`App server running at http://localhost:${port}/`);
  });
